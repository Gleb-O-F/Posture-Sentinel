# PRD: AI Posture Sentinel (Rust Edition)

## 1. Обзор продукта

AI Posture Sentinel — это легковесное десктопное приложение для Windows, которое использует веб-камеру и алгоритмы компьютерного зрения для мониторинга осанки пользователя в реальном времени. Приложение уведомляет пользователя о нарушении осанки путем постепенного размытия экрана (эффект "тумана").

---

## 2. Цели и задачи

| Цель | Описание |
|------|----------|
| **Производительность** | Использование GPU Quadro P1000 для инференса нейросети (целевой FPS: 20-30) |
| **Энергоэффективность** | Потребление ресурсов GPU не более 15%, CPU не более 5% в фоновом режиме |
| **Приватность** | Локальная обработка видеопотока без передачи данных в облако |

---

## 3. Технологический стек

| Компонент | Технология |
|-----------|------------|
| **Язык программирования** | Rust (стабильная версия) |
| **CV библиотека** | `opencv-rust` (захват и препроцессинг) |
| **ML Инференс** | `ort` (ONNX Runtime) с поддержкой CUDA Execution Provider |
| **Модель** | BlazePose (MediaPipe) в формате `.onnx` (FP16 или INT8 для оптимизации под Pascal) |
| **UI/Системные эффекты** | `winit` (окна), `window-vibrancy` (эффект Acrylic/Blur) |

---

## 4. Функциональные требования

### 4.1. Модуль отслеживания (Tracking)

Приложение должно извлекать **33 ключевые точки тела** (Landmarks), фокусируясь на:

- `LEFT_SHOULDER` (точка 11)
- `RIGHT_SHOULDER` (точка 12)
- `LEFT_EAR` (точка 7)
- `RIGHT_EAR` (точка 8)
- `NOSE` (точка 0)

### 4.2. Калибровка (Calibration)

Пользователь должен иметь возможность зафиксировать «эталонную позу»:

1. Пользователь нажимает кнопку «Откалибровать»
2. Система сохраняет координаты $y_{base}$ для плеч и расстояние $d_{base}$ между ушами (глубина)
3. Параметры сохраняются в `config.toml`

### 4.3. Алгоритм детекции нарушений

Программа фиксирует нарушение, если выполняется одно из условий в течение $T > 3$ секунд:

| Тип нарушения | Условие |
|--------------|---------|
| **Сутулость (Slouching)** | Средняя высота плеч $y_{current}$ опустилась ниже $y_{base}$ на порог $H$ |
| **Наклон вперед (Forward Lean)** | Расстояние между ушами $d_{current}$ увеличилось относительно $d_{base}$ на 15% (пользователь приблизился к камере) |
| **Наклон головы** | Угол между вектором плеч и вектором ушей отклонился более чем на $15^{\circ}$ |

### 4.4. Система уведомлений (The Punishment)

Мягкая система обратной связи — постепенное размытие экрана

